<template lang="jade">
div.container.questionListContainer
    div.export-graph
        div.row-top.row
            div.row--rtl
                div.overlay-container
                    img.t11(:src='preload', v-img='teethImg["11"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["11"].hook', v-if='teethImg["11"].hook')
                div.overlay-container
                    img.t12(:src='preload', v-img='teethImg["12"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["12"].hook', v-if='teethImg["12"].hook')
                div.overlay-container
                    img.t13(:src='preload', v-img='teethImg["13"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["13"].hook', v-if='teethImg["13"].hook')
                div.overlay-container
                    img.t14(:src='preload', v-img='teethImg["14"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["14"].hook', v-if='teethImg["14"].hook')
                div.overlay-container
                    img.t15(:src='preload', v-img='teethImg["15"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["15"].hook', v-if='teethImg["15"].hook')
                div.overlay-container
                    img.t16(:src='preload', v-img='teethImg["16"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["16"].hook', v-if='teethImg["16"].hook')
                div.overlay-container
                    img.t17(:src='preload', v-img='teethImg["17"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["17"].hook', v-if='teethImg["17"].hook')
                div.overlay-container
                    img.t18(:src='preload', v-img='teethImg["18"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["18"].hook', v-if='teethImg["18"].hook')
            div.row--ltr
                div.overlay-container
                    img.t21(:src='preload', v-img='teethImg["21"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["21"].hook', v-if='teethImg["21"].hook')
                div.overlay-container
                    img.t22(:src='preload', v-img='teethImg["22"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["22"].hook', v-if='teethImg["22"].hook')
                div.overlay-container
                    img.t23(:src='preload', v-img='teethImg["23"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["23"].hook', v-if='teethImg["23"].hook')
                div.overlay-container
                    img.t24(:src='preload', v-img='teethImg["24"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["24"].hook', v-if='teethImg["24"].hook')
                div.overlay-container
                    img.t25(:src='preload', v-img='teethImg["25"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["25"].hook', v-if='teethImg["25"].hook')
                div.overlay-container
                    img.t26(:src='preload', v-img='teethImg["26"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["26"].hook', v-if='teethImg["26"].hook')
                div.overlay-container
                    img.t27(:src='preload', v-img='teethImg["27"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["27"].hook', v-if='teethImg["27"].hook')
                div.overlay-container
                    img.t28(:src='preload', v-img='teethImg["28"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["28"].hook', v-if='teethImg["28"].hook')
        div.row-down.row
            div.row--rtl
                div.overlay-container
                    img.t41(:src='preload', v-img='teethImg["41"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["41"].hook', v-if='teethImg["41"].hook')
                div.overlay-container
                    img.t42(:src='preload', v-img='teethImg["42"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["42"].hook', v-if='teethImg["42"].hook')
                div.overlay-container
                    img.t43(:src='preload', v-img='teethImg["43"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["43"].hook', v-if='teethImg["43"].hook')
                div.overlay-container
                    img.t44(:src='preload', v-img='teethImg["44"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["44"].hook', v-if='teethImg["44"].hook')
                div.overlay-container
                    img.t45(:src='preload', v-img='teethImg["45"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["45"].hook', v-if='teethImg["45"].hook')
                div.overlay-container
                    img.t46(:src='preload', v-img='teethImg["46"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["46"].hook', v-if='teethImg["46"].hook')
                div.overlay-container
                    img.t47(:src='preload', v-img='teethImg["47"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["47"].hook', v-if='teethImg["47"].hook')
                div.overlay-container
                    img.t48(:src='preload', v-img='teethImg["48"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["48"].hook', v-if='teethImg["48"].hook')
            div.row--ltr
                div.overlay-container
                    img.t31(:src='preload', v-img='teethImg["31"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["31"].hook', v-if='teethImg["31"].hook')
                div.overlay-container
                    img.t32(:src='preload', v-img='teethImg["32"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["32"].hook', v-if='teethImg["32"].hook')
                div.overlay-container
                    img.t33(:src='preload', v-img='teethImg["33"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["33"].hook', v-if='teethImg["33"].hook')
                div.overlay-container
                    img.t34(:src='preload', v-img='teethImg["34"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["34"].hook', v-if='teethImg["34"].hook')
                div.overlay-container
                    img.t35(:src='preload', v-img='teethImg["35"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["35"].hook', v-if='teethImg["35"].hook')
                div.overlay-container
                    img.t36(:src='preload', v-img='teethImg["36"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["36"].hook', v-if='teethImg["36"].hook')
                div.overlay-container
                    img.t37(:src='preload', v-img='teethImg["37"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["37"].hook', v-if='teethImg["37"].hook')
                div.overlay-container
                    img.t38(:src='preload', v-img='teethImg["38"].tooth')
                    img.hooks(:src='preload', v-img='teethImg["38"].hook', v-if='teethImg["38"].hook')
div.control-btn-down.control-btn-down--previous previous
div.control-btn-down.control-btn-down--export export
div.control-btn-up
    img.control-btn-up-logo(src='/imgs/itp_Logo.png')
    div.vitality.control-btn-up-block
        div.control-btn-up-text
            p Vita-
            p lity
        img(src='/imgs/buttons_on.png')
    div.perio-chart.control-btn-up-block
        div.control-btn-up-text
            p Perio-
            p chart
        img(src='/imgs/buttons_on.png')



</template>

<script>
import _ from 'lodash'
import { allTeeth } from '../vuex/teethConstructor'
import { getQuestions } from '../vuex/getters'

export default {
    vuex: {
        getters: {
            questions: getQuestions
        }
    },
    data() {
        return {
            preload: 'http://design.ubuntu.com/wp-content/uploads/logo-ubuntu_su-white-hex-140x140.png'
        }
    },
    ready() {
    },
    computed: {
        teethImg() {
            return this.allTeeth().reduce((carry, teeth) => {
                const status = this.statusMapper(teeth)
                carry[teeth] = {}
                carry[teeth].tooth = `/imgs/teeth/${teeth}/${status.tooth}.png`
                carry[teeth].hook = status.hook ? `/imgs/hooks/${teeth}/${status.hook}.png` : false
                return carry
            }, {})
        }
    },
    methods: {
        allTeeth,
        statusMapper(toothID) {
            const teethIndex = _.findIndex(this.questions[0].teeth, obj => obj.id === toothID)
            if (this.questions[1 - 1].teeth[teethIndex].selected) {// CD
                if (this.questions[2 - 1].teeth[teethIndex].selected) {// CD + Implant
                    return this.statusBuilder('17')
                }
                if (this.questions[4 - 1].teeth[teethIndex].selected) {// CD + RR
                    if (this.questions[7 - 1].teeth[teethIndex].selected) {// CD + RR + post
                        if (this.questions[9 - 1].teeth[teethIndex].selected) {// CD + RR + post + decayed teeth
                            return this.statusBuilder('25')
                        }
                        return this.statusBuilder('15')
                    }
                    if (this.questions[9 - 1].teeth[teethIndex].selected) {// CD + RR + decayed teeth
                        return this.statusBuilder('26')
                    }
                    return this.statusBuilder('14')
                }
                return this.statusBuilder('16')
            }
            if (this.questions[2 - 1].teeth[teethIndex].selected) {// Implant
                if (this.questions[5 - 1].teeth.a[teethIndex].selected === 'M') {// Implant + FPD(M)
                    return this.statusBuilder('11')
                } else if (this.questions[5 - 1].teeth.a[teethIndex].selected === 'P') {// Implant + FPD(P)
                    return this.statusBuilder('07')
                }
                if (this.questions[8 - 1].teeth.a[teethIndex].selected) {// Implant + RPD
                    return this.statusBuilder('17')
                }
                return this.statusBuilder('04')
            }
            if (this.questions[3 - 1].teeth[teethIndex].selected) {// Missing Teeth
                if (this.questions[5 - 1].teeth.a[teethIndex].selected === 'M') {// Missing Teeth + FPD(M)
                    return this.statusBuilder('10')
                } else if (this.questions[5 - 1].teeth.a[teethIndex].selected === 'P') {// Missing Teeth + FPD(P)
                    return this.statusBuilder('06')
                }
                return this.statusBuilder('03')
            }
            if (this.questions[4 - 1].teeth[teethIndex].selected) {// RR
                if (this.questions[7 - 1].teeth[teethIndex].selected) {// RR + post
                    if (this.questions[8 - 1].teeth.a[teethIndex].selected && this.questions[9 - 1].teeth[teethIndex].selected) {// RR + post + RPD + decayed teeth
                        return this.statusBuilder('25')
                    }
                    if (this.questions[8 - 1].teeth.a[teethIndex].selected) {// RR + post + RPD
                        return this.statusBuilder('15')
                    }
                    if (this.questions[9 - 1].teeth[teethIndex].selected) {// RR + post + decayed teeth
                        return this.statusBuilder('28')
                    }
                    return this.statusBuilder('27')
                }
                if (this.questions[8 - 1].teeth.a[teethIndex].selected) {// RR + RPD
                    if (this.questions[9 - 1].teeth[teethIndex].selected) {// RR + RPD + decayed teeth
                        return this.statusBuilder('26')
                    }
                    return this.statusBuilder('14')
                }
                if (this.questions[9 - 1].teeth[teethIndex].selected) {// RR + decayed teeth
                    return this.statusBuilder('19')
                }
                return this.statusBuilder('02')
            }
            if (this.questions[5 - 1].teeth.a[teethIndex].selected === 'M') {// FPD(M)
                if (this.questions[7 - 1].teeth[teethIndex].selected && this.questions[9 - 1].teeth[teethIndex].selected) {// FPD(M) + posts + decayed teeth
                    return this.statusBuilder('22')
                }
                if (this.questions[7 - 1].teeth[teethIndex].selected) {// FPD(M) + posts
                    return this.statusBuilder('09')
                }
                if (this.questions[9 - 1].teeth[teethIndex].selected) {// FPD(M) + decayed teeth
                    return this.statusBuilder('23')
                }
                return this.statusBuilder('08')
            } else if (this.questions[5 - 1].teeth.a[teethIndex].selected === 'P') {// FPD(P)
                if (this.questions[7 - 1].teeth[teethIndex].selected && this.questions[9 - 1].teeth[teethIndex].selected) {// FPD(P) + posts + decayed teeth
                    return this.statusBuilder('20')
                }
                if (this.questions[7 - 1].teeth[teethIndex].selected) {// FPD(P) + posts
                    return this.statusBuilder('13')
                }
                if (this.questions[9 - 1].teeth[teethIndex].selected) {// FPD(P) + decayed teeth
                    return this.statusBuilder('21')
                }
                return this.statusBuilder('05')
            }
            if (this.questions[6 - 1].teeth[teethIndex].selected) {// Veneer
                if (this.questions[9 - 1].teeth[teethIndex].selected) {// Veneer + decayed teeth
                    return this.statusBuilder('24')
                }
                return this.statusBuilder('12')
            }
            if (this.questions[7 - 1].teeth[teethIndex].selected) {// posts
                if (this.questions[9 - 1].teeth[teethIndex].selected) {// posts + decayed teeth
                    return this.statusBuilder('28')
                }
                return this.statusBuilder('27')
            }
            if (this.questions[9 - 1].teeth[teethIndex].selected) {// decayed teeth
                return this.statusBuilder('18')
            }
            if (this.questions[8 - 1].teeth.a[teethIndex].selected) {// RPD
                return this.statusBuilder('16', '80')
            }
            return this.statusBuilder('01')// nothing matched => default
        },
        statusBuilder(tooth, hook = false) {
            return {
                tooth,
                hook
            }
        }
    }
}
</script>

<style lang="stylus" scoped>
/*@import '/resources/assets/stylus/teeth.styl'*/
total-width-1 = 600
total-width-2 = 600
total-width-3 = 600
total-width-4 = 600
.control-btn-up-text
    font-size 30px
    line-height 20px
    font-weight bold
    letter-spacing 8px
    text-align right

.control-btn-up
    position fixed
    top 20px
    right 40px
    height 100px
    display flex
    flex-direction row
    align-items center
    img.control-btn-up-logo
        width 60px
        margin-right 15px
    .control-btn-up-block
        display flex
        align-items center
        img
            cursor pointer
            width 35px
    .vitality
        margin-right 15px

div.overlay-container
    position relative
    img:nth-child(1)
        width 100%

div.export-graph
    width 100%
    padding 5%
    img.hooks
        position absolute
        top 0
        left 0
        max-height 200px
div.row
    display flex
    flex-direction row
    max-height 200px
    div.row--rtl
        display flex
        flex-direction row-reverse
    div.row--ltr
        display flex
        flex-direction row

.control-btn-down
    position fixed
    bottom 20px
    font-size 50px
    font-weight bold
    cursor pointer
    &.control-btn-down--previous
        left 40px
    &.control-btn-down--export
        right 40px
    &:hover
        text-shadow -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000
        color white

        /*&.t11
            width percentage(75 / total-width-1)
        &.t12
            width percentage(61 / total-width-1)
        &.t13
            width percentage(65 / total-width-1)
        &.t14
            width percentage(66 / total-width-1)
        &.t15
            width percentage(64 / total-width-1)
        &.t16
            width percentage(100 / total-width-1)
        &.t17
            width percentage(87 / total-width-1)
        &.t18
            width percentage(82 / total-width-1)*/

        /*&.t21
            width percentage(75 / total-width-2)
        &.t22
            width percentage(61 / total-width-2)
        &.t23
            width percentage(64 / total-width-2)
        &.t24
            width percentage(67 / total-width-2)
        &.t25
            width percentage(63 / total-width-2)
        &.t26
            width percentage(100 / total-width-2)
        &.t27
            width percentage(87 / total-width-2)
        &.t28
            width percentage(83 / total-width-2)

        &.t31
            width percentage(46 / total-width-3)
        &.t32
            width percentage(49 / total-width-3)
        &.t33
            width percentage(55 / total-width-3)
        &.t34
            width percentage(64 / total-width-3)
        &.t35
            width percentage(66 / total-width-3)
        &.t36
            width percentage(95 / total-width-3)
        &.t37
            width percentage(96 / total-width-3)
        &.t38
            width percentage(129 / total-width-3)

        &.t41
            width percentage(46 / total-width-4)
        &.t42
            width percentage(49 / total-width-4)
        &.t43
            width percentage(55 / total-width-4)
        &.t44
            width percentage(64 / total-width-4)
        &.t45
            width percentage(66 / total-width-4)
        &.t46
            width percentage(94 / total-width-4)
        &.t47
            width percentage(97 / total-width-4)
        &.t48
            width percentage(129 / total-width-4)*/
</style>
